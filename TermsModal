import React, { useState, useRef, useEffect } from "react";
import { motion } from "framer-motion";
import { AlertCircle, Heart, Clock, Users, Shield, CheckCircle, Star, Sparkles, Award, Music } from "lucide-react";
import { Button } from "@/components/ui/button";
import { Checkbox } from "@/components/ui/checkbox";
import { Progress } from "@/components/ui/progress";

export default function TermsModal({ onAccept }) {
  const [isChecked, setIsChecked] = useState(false);
  const [hasScrolledToBottom, setHasScrolledToBottom] = useState(false);
  const [scrollProgress, setScrollProgress] = useState(0);
  const scrollContainerRef = useRef(null);

  useEffect(() => {
    const handleScroll = () => {
      const container = scrollContainerRef.current;
      if (!container) return;

      const scrollHeight = container.scrollHeight - container.clientHeight;
      const scrolled = container.scrollTop;
      const progress = Math.min((scrolled / scrollHeight) * 100, 100);
      
      setScrollProgress(progress);
      
      if (scrollHeight - scrolled < 20) {
        setHasScrolledToBottom(true);
      }
    };

    const container = scrollContainerRef.current;
    if (container) {
      container.addEventListener("scroll", handleScroll);
      return () => container.removeEventListener("scroll", handleScroll);
    }
  }, []);

  return (
    <motion.div
      initial={{ opacity: 0 }}
      animate={{ opacity: 1 }}
      exit={{ opacity: 0 }}
      className="fixed inset-0 bg-gradient-to-br from-amber-900/40 via-black/90 to-purple-900/40 backdrop-blur-md z-50 flex items-center justify-center p-4"
    >
      <motion.div
        initial={{ scale: 0.9, opacity: 0 }}
        animate={{ scale: 1, opacity: 1 }}
        exit={{ scale: 0.9, opacity: 0 }}
        transition={{ type: "spring", duration: 0.5 }}
        className="relative bg-gradient-to-b from-gray-900 to-black border-2 border-amber-500/30 rounded-3xl shadow-2xl max-w-3xl w-full max-h-[90vh] overflow-hidden flex flex-col"
      >
        {/* Header */}
        <div className="bg-gradient-to-r from-amber-600/20 to-purple-600/20 backdrop-blur-sm px-6 py-5 border-b-2 border-amber-500/20 flex-shrink-0">
          <div className="flex items-center justify-center gap-3 mb-2">
            <Sparkles className="w-6 h-6 text-amber-400" />
            <h2 className="text-2xl font-black text-amber-100 text-center">Welcome to Your Journey</h2>
            <Sparkles className="w-6 h-6 text-amber-400" />
          </div>
          <p className="text-amber-200/80 text-sm text-center font-medium">Before we begin, let's talk about what this means</p>
        </div>

        {/* Scroll Progress */}
        <div className="bg-gray-900/80 px-6 py-3 border-b border-amber-500/20 flex-shrink-0">
          <div className="flex items-center justify-between mb-2">
            <p className="text-sm font-semibold">
              {hasScrolledToBottom ? (
                <span className="text-green-400 flex items-center gap-2">
                  <CheckCircle className="w-4 h-4" />
                  You're all set! âœ¨
                </span>
              ) : (
                <span className="text-amber-400">Keep reading: {Math.round(scrollProgress)}%</span>
              )}
            </p>
          </div>
          <Progress value={scrollProgress} className="h-1.5 bg-gray-800" />
        </div>

        {/* Content */}
        <div 
          ref={scrollContainerRef}
          className="flex-1 overflow-y-auto px-6 py-6 bg-gradient-to-b from-black to-gray-950"
        >
          <div className="space-y-8 text-gray-300">
            
            {/* Welcome Message */}
            <div className="bg-gradient-to-br from-amber-900/20 to-purple-900/20 border border-amber-500/30 rounded-2xl p-6 text-center">
              <Heart className="w-8 h-8 text-amber-400 mx-auto mb-3" />
              <h3 className="text-xl font-bold text-amber-100 mb-3">Thank You for Your Interest! ðŸ’«</h3>
              <p className="text-amber-200/90 leading-relaxed">
                We're so excited that you're considering joining us on this incredible journey. 
                Before you audition, we want to make sure you understand what New Academy is all about 
                and what we're looking for in our members. Take your time reading through everythingâ€”this is important!
              </p>
            </div>

            {/* What is New Academy */}
            <div>
              <h3 className="text-xl font-bold text-amber-100 mb-4 flex items-center gap-2">
                <Star className="w-6 h-6 text-amber-400" />
                What is New Academy?
              </h3>
              <div className="bg-white/5 border border-white/20 rounded-xl p-5 space-y-3">
                <p className="leading-relaxed">
                  <strong className="text-amber-200">New Academy</strong> is the name of this audition programâ€”it's <strong className="text-amber-200">not</strong> the final name of the group. 
                  We're still deciding on that together as a team!
                </p>
                <p className="leading-relaxed">
                  We're an <strong className="text-amber-200">independent, faith-based initiative</strong> created by passionate people who love K-pop and want to use it 
                  to spread a positive Christian message. We're <strong className="text-amber-200">not a big professional label</strong> with lots of resourcesâ€”we're starting from the ground up, 
                  building something meaningful with heart and dedication.
                </p>
                <p className="leading-relaxed">
                  Because we're independent, things might move slower than you'd expect from a professional company. 
                  We appreciate your patience and understanding as we work hard to make this dream a reality! ðŸŒŸ
                </p>
              </div>
            </div>

            {/* Age Requirements */}
            <div>
              <h3 className="text-xl font-bold text-amber-100 mb-4 flex items-center gap-2">
                <Clock className="w-6 h-6 text-amber-400" />
                Who Can Join?
              </h3>
              <div className="bg-white/5 border border-white/20 rounded-xl p-5 space-y-3">
                <div className="bg-amber-900/30 border-l-4 border-amber-500 rounded-lg p-4">
                  <p className="text-amber-100 font-bold text-lg mb-2">Age Requirement: 12-14 Years Old</p>
                  <p className="text-amber-200/90">
                    You must be between 12 and 14 years old at the time of audition. We chose this age range because 
                    it's the perfect time for training and growth, both as an artist and as a person. No exceptions can be made to this requirement.
                  </p>
                </div>
                <p className="leading-relaxed">
 
